version: '3.8'

services:
  api:
    build: ./api-layer
    container_name: ci4-api
    restart: unless-stopped
    ports:
      - "8080:80"
    volumes:
      - ./api-layer:/var/www/html:cached
      - ./api-layer/.env:/var/www/html/.env:ro
    environment:
      - COMPOSER_ALLOW_SUPERUSER=1

  frontend:
    build: ./frontend
    container_name: ci4-frontend
    restart: unless-stopped
    ports:
      - "3000:80"
    volumes:
      - ./frontend:/usr/share/nginx/html:ro
    depends_on:
      - api

# Optional database service example (uncomment if you need DB)
#  db:
#    image: mysql:8.0
#    container_name: ci4-db
#    restart: unless-stopped
#    environment:
#      MYSQL_ROOT_PASSWORD: example
#      MYSQL_DATABASE: ci4_db
#    ports:
#      - "3306:3306"
#    volumes:
#      - db_data:/var/lib/mysql

#volumes:
#  db_data:
#    driver: local
